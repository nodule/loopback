{
  "name": "loopback",
  "description": "Loopback for ChiÏ‡",
  "version": "0.0.3",
  "repository": {
    "type": "git",
    "url": "https://github.com/nodule/loopback.git"
  },
  "dependencies": {
    "loopback": "1.x.x",
    "loopback-connector-mongodb": "1.x.x",
    "loopback-connector-rest": "1.x.x",
    "loopback-datasource-juggler": "1.x.x"
  },
  "nodes": [
    {
      "name": "afterRemote",
      "ns": "loopback",
      "description": "After Remote Model Action",
      "phrases": {
        "active": "Defining afterRemote {{input.type}} Action"
      },
      "ports": {
        "input": {
          "model": {
            "type": "function",
            "title": "Model",
            "readonly": "true"
          },
          "type": {
            "enum": [
              "create"
            ],
            "title": "Type",
            "description": "AfterRemote action type"
          }
        },
        "output": {
          "ctx": {
            "type": "object",
            "title": "ctx",
            "description": "Ctx"
          },
          "user": {
            "type": "object",
            "title": "user"
          },
          "next": {
            "type": "function",
            "title": "next"
          }
        }
      },
      "env": "server",
      "fn": "output = [input.model, input.type]\n"
    },
    {
      "name": "app",
      "ns": "loopback",
      "description": "Loopback App",
      "phrases": {
        "active": "Init Loopback App"
      },
      "ports": {
        "input": {
          "loopback": {
            "title": "Loopback",
            "type": "function"
          }
        },
        "output": {
          "app": {
            "title": "App",
            "type": "function"
          }
        }
      },
      "env": "server",
      "fn": "output = { app: input.loopback() }\n"
    },
    {
      "name": "userEmailConfirmReset",
      "ns": "loopback",
      "description": "Confirm User Email Reset",
      "phrases": {
        "active": "Confirming user email reset"
      },
      "ports": {
        "input": {
          "user": {
            "type": "function",
            "title": "User Model"
          },
          "token": {
            "type": "string",
            "title": "Token"
          }
        }
      },
      "output": {
        "error": {
          "type": "object",
          "title": "Error",
          "description": "Error"
        }
      },
      "env": "server",
      "fn": "output = [input.user, 'confirmReset', input.token]\n"
    },
    {
      "name": "createUser",
      "ns": "loopback",
      "description": "Create a User",
      "phrases": {
        "active": "Creating User"
      },
      "ports": {
        "input": {
          "user": {
            "type": "function",
            "title": "User",
            "readonly": "true"
          },
          "user_info": {
            "type": "object",
            "title": "User Info",
            "description": "A user object",
            "readonly": "true"
          }
        },
        "output": {
          "error": {
            "type": "object",
            "title": "Error",
            "description": "Error"
          },
          "user": {
            "type": "object",
            "title": "User",
            "description": "User"
          }
        }
      },
      "env": "server",
      "fn": "output = [input.user, 'create', input.user_info]\n"
    },
    {
      "name": "dynamicModel",
      "ns": "loopback",
      "description": "Dynamic Loopback Model",
      "phrases": {
        "active": "Creating Dynamic Model {{input.name}}"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": true,
            "required": true
          },
          "name": {
            "type": "string",
            "title": "Model name",
            "required": true
          }
        },
        "output": {
          "model": {
            "type": "object",
            "description": "Dynamic model instance"
          }
        }
      },
      "env": "server",
      "fn": "output = { model: input.loopback.Model.extend(input.name) }\n"
    },
    {
      "name": "exposeModel",
      "ns": "loopback",
      "description": "Expose Loopback Model",
      "phrases": {
        "active": "Exposing Model {{input.model.modelName}}"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": true,
            "required": true
          },
          "model": {
            "type": "function",
            "title": "Model",
            "required": true
          }
        },
        "output": {}
      },
      "env": "server",
      "fn": "input.loopback.model(input.model)\n"
    },
    {
      "name": "findOne",
      "ns": "loopback",
      "description": "findOne",
      "phrases": {
        "active": "Finding one {{input.model.name}}"
      },
      "ports": {
        "input": {
          "model": {
            "type": "object",
            "title": "Model",
            "description": "Model object",
            "readonly": "true"
          },
          "criteria": {
            "type": "object",
            "title": "Criteria",
            "description": "Search Criteria"
          }
        },
        "output": {
          "error": {
            "type": "object",
            "title": "Error",
            "description": "Error"
          },
          "model": {
            "type": "object",
            "title": "Model",
            "description": "The model"
          }
        }
      },
      "env": "server",
      "fn": "output = [input.model, 'findOne', input.criteria]\n"
    },
    {
      "name": "listen",
      "ns": "express",
      "description": "express listen",
      "phrases": {
        "active": "listening on port {{input.port}}, ?address?"
      },
      "ports": {
        "input": {
          "app": {
            "type": "function",
            "title": "Express app",
            "readonly": true,
            "required": true
          },
          "port": {
            "type": "string",
            "title": "Port",
            "description": "The port this express app should listen on",
            "required": true
          }
        },
        "output": {
          "server": {
            "type": "object"
          }
        }
      },
      "env": "server",
      "fn": "output = { server: input.app.listen(input.port) }\n"
    },
    {
      "name": "login",
      "ns": "loopback",
      "description": "User login",
      "phrases": {
        "active": "Logging in user {{input.username}}"
      },
      "ports": {
        "input": {
          "user": {
            "type": "object",
            "title": "User",
            "description": "User object",
            "readonly": "true"
          },
          "login": {
            "type": "object",
            "title": "Login info",
            "description": "Requires { username: 'foo', password: 'bar' }"
          }
        },
        "output": {
          "error": {
            "type": "object",
            "title": "Error",
            "description": "Error"
          },
          "session": {
            "type": "object",
            "title": "Session",
            "description": "User Session"
          }
        }
      },
      "env": "server",
      "fn": "output = [input.user, 'login', input.login]\n"
    },
    {
      "name": "logout",
      "ns": "loopback",
      "description": "User logout",
      "phrases": {
        "active": "Logging out user"
      },
      "ports": {
        "input": {
          "user": {
            "type": "object",
            "title": "User",
            "description": "User object",
            "readonly": "true"
          },
          "session_id": {
            "type": "string",
            "title": "Session ID",
            "description": "User Session ID"
          }
        },
        "output": {
          "error": {
            "type": "object",
            "title": "Error",
            "description": "Error"
          }
        }
      },
      "env": "server",
      "fn": "output = [input.user, 'logout', input.session_id]\n"
    },
    {
      "name": "loopback",
      "title": "Loopback",
      "ns": "loopback",
      "description": "Loopback",
      "phrases": {
        "active": "Creating Loopback"
      },
      "require": {
        "loopback": "1.x.x"
      },
      "ports": {
        "input": {},
        "output": {
          "loopback": {
            "title": "Loopback",
            "type": "function"
          }
        }
      },
      "env": "server",
      "fn": "output = { loopback: loopback }\n"
    },
    {
      "name": "mail",
      "ns": "loopback",
      "description": "Mail connector",
      "phrases": {
        "active": "Creating Mail datasource"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": "true"
          },
          "transports": {
            "title": "Transports",
            "type": "Array",
            "items": {
              "type": {
                "enum": [
                  "smtp"
                ],
                "title": "Type",
                "default": "smtp"
              },
              "host": {
                "type": "string",
                "title": "Host"
              },
              "port": {
                "type": "string",
                "title": "Port"
              },
              "secureConnection": {
                "type": "boolean",
                "title": "Boolean",
                "default": true
              },
              "auth": {
                "type": "object",
                "title": "Auth",
                "properties": {
                  "user": {
                    "type": "string",
                    "title": "User"
                  },
                  "password": {
                    "type": "password",
                    "title": "Password"
                  }
                }
              }
            }
          }
        },
        "output": {
          "mail": {
            "type": "object",
            "title": "Mail"
          }
        }
      },
      "env": "server",
      "fn": "output = { mail: input.loopback.createDataSource({\n  connector: input.loopback.Mail,\n  transports: input.transports\n}) }\n"
    },
    {
      "name": "memory",
      "ns": "loopback",
      "description": "Memory connector",
      "phrases": {
        "active": "Creating Memory datasource"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": "true"
          }
        },
        "output": {
          "memory": {
            "type": "object",
            "title": "Memory",
            "description": "Memory Connector"
          }
        }
      },
      "env": "server",
      "fn": "output = { memory: input.loopback.memory() }\n"
    },
    {
      "name": "models",
      "ns": "loopback",
      "description": "Get exposed models",
      "phrases": {
        "active": "Getting exposed Models"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": true,
            "required": true
          }
        },
        "output": {
          "models": {
            "type": "array",
            "title": "Models",
            "description": "An array of models"
          }
        }
      },
      "env": "server",
      "fn": "input.loopback.models()\n"
    },
    {
      "name": "mongodb",
      "ns": "loopback",
      "description": "MongoDB connector",
      "phrases": {
        "active": "Creating MongoDB datasource"
      },
      "require": {
        "loopback-datasource-juggler": "1.x.x",
        "loopback-connector-mongodb": "1.x.x"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": "true"
          },
          "settings": {
            "title": "Settings",
            "properties": {
              "host": {
                "type": "string",
                "title": "Host",
                "default": "localhost"
              },
              "port": {
                "type": "string",
                "title": "Port",
                "default": "27017"
              },
              "database": {
                "type": "string",
                "title": "Database",
                "default": "test"
              }
            }
          },
          "login": {
            "title": "Login Information",
            "properties": {
              "username": {
                "type": "string",
                "title": "Username"
              },
              "password": {
                "type": "password",
                "title": "Password"
              }
            }
          },
          "debug": {
            "type": "boolean",
            "title": "Debug"
          }
        },
        "output": {
          "db": {
            "type": "object",
            "title": "DB"
          }
        }
      },
      "env": "server",
      "fn": "var DataSource = loopback_datasource_juggler.DataSource;\noutput = { db: input.loopback.createDataSource({ connector: loopback_connector_mongodb }) }\n"
    },
    {
      "name": "rest",
      "ns": "loopback",
      "description": "REST connector",
      "phrases": {
        "active": "Creating REST datasource"
      },
      "require": {
        "loopback-connector-rest": "1.x.x"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": "true"
          }
        },
        "output": {
          "db": {
            "type": "object",
            "title": "DB"
          }
        }
      },
      "env": "server",
      "fn": "output = { db: input.loopback.createDataSource({ connector: loopback_connector_rest }) }\n"
    },
    {
      "name": "restRouter",
      "ns": "loopback",
      "description": "Rest Router",
      "phrases": {
        "active": "Using REST Router"
      },
      "ports": {
        "input": {
          "app": {
            "type": "function",
            "title": "App",
            "readonly": true,
            "required": true
          },
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": true,
            "required": true
          }
        },
        "output": {}
      },
      "env": "server",
      "fn": "input.app.use(input.loopback.rest())\n"
    },
    {
      "name": "user",
      "ns": "loopback",
      "description": "User Model",
      "phrases": {
        "active": "Creating User Model"
      },
      "ports": {
        "input": {
          "loopback": {
            "type": "function",
            "title": "Loopback",
            "readonly": "true"
          },
          "user_connector": {
            "type": "function",
            "title": "User Connector",
            "readonly": "true"
          },
          "session_connector": {
            "type": "function",
            "title": "Session Connector",
            "readonly": "true"
          }
        },
        "output": {
          "user": {
            "type": "object",
            "title": "User",
            "description": "User"
          }
        }
      },
      "env": "server",
      "fn": "var User = input.loopback.User.extend('user');\nUser.attachTo(input.user_connector);\nUser.session.attachTo(input.session_connector);\noutput = { user: User }\n"
    },
    {
      "name": "userEmail",
      "ns": "loopback",
      "description": "User Email",
      "phrases": {
        "active": "Attaching User Email Datasource"
      },
      "ports": {
        "input": {
          "user": {
            "type": "function",
            "title": "User",
            "readonly": "true"
          },
          "mail": {
            "type": "object",
            "title": "Email Datasource",
            "description": "Email Datasource",
            "readonly": "true"
          }
        },
        "output": {}
      },
      "env": "server",
      "fn": "input.user.email.attachTo(input.mail)\ninput.user.requireEmailVerification = true;\n"
    },
    {
      "name": "userEmailReset",
      "ns": "loopback",
      "description": "Reset User Email",
      "phrases": {
        "active": "Resetting user email for {{input.user.email}}"
      },
      "ports": {
        "input": {
          "user": {
            "type": "function",
            "title": "User Model"
          },
          "user_info": {
            "type": "object",
            "title": "User"
          }
        }
      },
      "output": {
        "error": {
          "type": "object",
          "title": "Error",
          "description": "Error"
        }
      },
      "env": "server",
      "fn": "output = [input.user, 'reset', input.user_info.email]\n"
    },
    {
      "name": "userVerify",
      "ns": "loopback",
      "description": "Verfify User",
      "phrases": {
        "active": "Verifying user email for {{input.options.email}}"
      },
      "ports": {
        "input": {
          "user": {
            "type": "object",
            "title": "User"
          },
          "options": {
            "type": "object",
            "properties": {
              "from": {
                "type": "email",
                "title": "Email"
              },
              "subject": {
                "type": "string",
                "title": "Subject",
                "default": "Thanks for Registering at FooBar"
              },
              "text": {
                "type": "string",
                "title": "Text",
                "default": "Please verify your email address!"
              },
              "template": {
                "type": "string",
                "title": "Template: [Problem needs a file]"
              },
              "redirect": {
                "type": "string",
                "title": "Redirect",
                "default": "/"
              }
            }
          }
        }
      },
      "output": {
        "error": {
          "type": "object",
          "title": "Error",
          "description": "Error"
        },
        "user": {
          "type": "object",
          "title": "User",
          "description": "User"
        }
      },
      "env": "server",
      "fn": "input.options.type = 'email'\ninput.options.to   = input.user.email\ninput.user.verify(input.options, input.next)\n"
    }
  ],
  "twigs": [],
  "env": "server"
}